% Model: demo
cd /home/jason/code/dnsim/demo;
spec=[];
spec.nodes(1).label = 'HH';
spec.nodes(1).multiplicity = 200;
spec.nodes(1).dynamics = {'v''=current/c'};
spec.nodes(1).mechanisms = {'HH_K','HH_Na','HH_input','HH_leak','HH_iM','HH_noise'};
spec.nodes(1).parameters = {'c',1,'v_IC',-65};
spec.nodes(2).label = 'HH2';
spec.nodes(2).multiplicity = 200;
spec.nodes(2).dynamics = {'v''=current/c'};
spec.nodes(2).mechanisms = {'HH2_K','HH2_Na','HH2_leak','HH2_iM','HH2_noise'};
spec.nodes(2).parameters = {'c',1,'v_IC',-65};
spec.connections(1,1).label = 'HH-HH';
spec.connections(1,1).mechanisms = {'HH_HH_iSYN'};
spec.connections(1,1).parameters = [];
spec.connections(1,2).label = 'HH-HH2';
spec.connections(1,2).mechanisms = {'HH_HH2_iCOM'};
spec.connections(1,2).parameters = [];
dnsim(spec); % open model in DNSim GUI

% Parse and compare DNSim models:
[ODEFUN,IC,functions,auxvars,FULLSPEC]=buildmodel2(spec,'verbose',1); % parse DNSim spec structure (returns ODEFUN handle and initial conditions IC for manual simulation and FULLSPEC for automatic simulation)
report=modeldiff(FULLSPEC,FULLSPEC) % compare two DNSim models
% DNSim simulation and plots:
sim_data = biosim(FULLSPEC,'timelimits',[0 100],'dt',.02,'dsfact',10); % wrapper to simulate DNSim models
plotv(sim_data,FULLSPEC,'varlabel','v'); % quickly plot select variables
visualizer(sim_data); % ugly interactive tool hijacked to visualize sim_data

% Manual simulation and plots:
%{
%-----------------------------------------------------------
% Auxiliary variables:
	HH_HH_iSYN_width     = inf;
	HH_HH_iSYN_Nmax      = max((200),(200));
	HH_HH_iSYN_srcpos    = linspace(1,HH_HH_iSYN_Nmax,(200))'*ones(1,(200));
	HH_HH_iSYN_dstpos    = (linspace(1,HH_HH_iSYN_Nmax,(200))'*ones(1,(200)))';
	HH_HH_iSYN_netcon    = exp(-(HH_HH_iSYN_srcpos-HH_HH_iSYN_dstpos).^2/(0.25*(200))^2)';
	HH_HH2_iCOM_compcon  = eye((200),(200));

% Anonymous functions:
	HH_K_an              = @(HH_v) .01*(HH_v+55)./(1-exp(-(HH_v+55)/10));
	HH_K_bn              = @(HH_v) .125*exp(-(HH_v+65)/80);        
	HH_K_ik              = @(HH_v,HH_K_n) (36)*(HH_K_n.^4).*(HH_v-(-77));
	HH_Na_am             = @(HH_v) .1*(HH_v+40)./(1-exp(-(HH_v+40)/10));
	HH_Na_bm             = @(HH_v) 4*exp(-(HH_v+65)/18);           
	HH_Na_ah             = @(HH_v) .07*exp(-(HH_v+65)/20);         
	HH_Na_bh             = @(HH_v) 1./(1+exp(-(HH_v+35)/10));      
	HH_Na_ina            = @(HH_v,HH_Na_m,HH_Na_h) (120)*HH_Na_h.*(HH_Na_m.^3).*(HH_v-(50));
	HH_input_I           = @(t) 20;                                
	HH_leak_ileak        = @(HH_v) (0.3)*(HH_v-(-54.4));           
	HH_iM_aM             = @(IN) (1).*(.02./(1+exp((-20-IN)/5)));  
	HH_iM_bM             = @(IN) (1).*(.01*exp((-43-IN)/18));      
	HH_iM_IM             = @(IN,m) (10).*m.*(IN-(-95));            
	HH_noise_noise       = @(t) (100).*randn((200),1).*sqrt((0.01));
	HH_HH_iSYN_ISYN      = @(V,HH_HH_iSYN_s) ((0.5).*(HH_HH_iSYN_netcon*HH_HH_iSYN_s).*(V-(0)));
	HH2_K_an             = @(HH2_v) .01*(HH2_v+55)./(1-exp(-(HH2_v+55)/10));
	HH2_K_bn             = @(HH2_v) .125*exp(-(HH2_v+65)/80);      
	HH2_K_ik             = @(HH2_v,HH2_K_n) (36)*(HH2_K_n.^4).*(HH2_v-(-77));
	HH2_Na_am            = @(HH2_v) .1*(HH2_v+40)./(1-exp(-(HH2_v+40)/10));
	HH2_Na_bm            = @(HH2_v) 4*exp(-(HH2_v+65)/18);         
	HH2_Na_ah            = @(HH2_v) .07*exp(-(HH2_v+65)/20);       
	HH2_Na_bh            = @(HH2_v) 1./(1+exp(-(HH2_v+35)/10));    
	HH2_Na_ina           = @(HH2_v,HH2_Na_m,HH2_Na_h) (120)*HH2_Na_h.*(HH2_Na_m.^3).*(HH2_v-(50));
	HH2_leak_ileak       = @(HH2_v) (0.3)*(HH2_v-(-54.4));         
	HH2_iM_aM            = @(IN) (1).*(.02./(1+exp((-20-IN)/5)));  
	HH2_iM_bM            = @(IN) (1).*(.01*exp((-43-IN)/18));      
	HH2_iM_IM            = @(IN,m) (10).*m.*(IN-(-95));            
	HH2_noise_noise      = @(t) (100).*randn((200),1).*sqrt((0.01));
	HH_HH2_iCOM_dV       = @(IN,OUT) ((IN*ones(1,size(IN,1)))'-(OUT*ones(1,size(OUT,1))));
	HH_HH2_iCOM_ICOM     = @(IN,OUT) (0.2).*sum((((IN*ones(1,size(IN,1)))'-(OUT*ones(1,size(OUT,1))))).*HH_HH2_iCOM_compcon,2);

% ODE Handle, ICs, integration, and plotting:
ODEFUN = @(t,X) [((-((36)*(X(201:400).^4).*(X(1:200)-(-77))))+((-((120)*X(601:800).*(X(401:600).^3).*(X(1:200)-(50))))+(((20))+((-((0.3)*(X(1:200)-(-54.4))))+((-((10).*X(801:1000).*(X(1:200)-(-95))))+((((100).*randn((200),1).*sqrt((0.01))))+((-(((0.5).*(HH_HH_iSYN_netcon*X(1001:1200)).*(X(1:200)-(0)))))+0)))))))/(1);(.01*(X(1:200)+55)./(1-exp(-(X(1:200)+55)/10))).*(1-X(201:400))-(.125*exp(-(X(1:200)+65)/80)).*X(201:400);(.1*(X(1:200)+40)./(1-exp(-(X(1:200)+40)/10))).*(1-X(401:600))-(4*exp(-(X(1:200)+65)/18)).*X(401:600);(.07*exp(-(X(1:200)+65)/20)).*(1-X(601:800))-(1./(1+exp(-(X(1:200)+35)/10))).*X(601:800);(((1).*(.02./(1+exp((-20-X(1:200))/5)))).*(1-X(801:1000))-((1).*(.01*exp((-43-X(1:200))/18))).*X(801:1000));-X(1001:1200)./(1) + ((1-X(1001:1200))/(0.25)).*(1+tanh(X(1:200)/10));((-((36)*(X(1401:1600).^4).*(X(1201:1400)-(-77))))+((-((120)*X(1801:2000).*(X(1601:1800).^3).*(X(1201:1400)-(50))))+((-((0.3)*(X(1201:1400)-(-54.4))))+((-((10).*X(2001:2200).*(X(1201:1400)-(-95))))+((((100).*randn((200),1).*sqrt((0.01))))+((((0.2).*sum((((X(1:200)*ones(1,size(X(1:200),1)))'-(X(1201:1400)*ones(1,size(X(1201:1400),1))))).*HH_HH2_iCOM_compcon,2)))+0))))))/(1);(.01*(X(1201:1400)+55)./(1-exp(-(X(1201:1400)+55)/10))).*(1-X(1401:1600))-(.125*exp(-(X(1201:1400)+65)/80)).*X(1401:1600);(.1*(X(1201:1400)+40)./(1-exp(-(X(1201:1400)+40)/10))).*(1-X(1601:1800))-(4*exp(-(X(1201:1400)+65)/18)).*X(1601:1800);(.07*exp(-(X(1201:1400)+65)/20)).*(1-X(1801:2000))-(1./(1+exp(-(X(1201:1400)+35)/10))).*X(1801:2000);(((1).*(.02./(1+exp((-20-X(1201:1400))/5)))).*(1-X(2001:2200))-((1).*(.01*exp((-43-X(1201:1400))/18))).*X(2001:2200));];
IC = [-65          -65          -65          -65          -65          -65          -65          -65          -65          -65          -65          -65          -65          -65          -65          -65          -65          -65          -65          -65          -65          -65          -65          -65          -65          -65          -65          -65          -65          -65          -65          -65          -65          -65          -65          -65          -65          -65          -65          -65          -65          -65          -65          -65          -65          -65          -65          -65          -65          -65          -65          -65          -65          -65          -65          -65          -65          -65          -65          -65          -65          -65          -65          -65          -65          -65          -65          -65          -65          -65          -65          -65          -65          -65          -65          -65          -65          -65          -65          -65          -65          -65          -65          -65          -65          -65          -65          -65          -65          -65          -65          -65          -65          -65          -65          -65          -65          -65          -65          -65          -65          -65          -65          -65          -65          -65          -65          -65          -65          -65          -65          -65          -65          -65          -65          -65          -65          -65          -65          -65          -65          -65          -65          -65          -65          -65          -65          -65          -65          -65          -65          -65          -65          -65          -65          -65          -65          -65          -65          -65          -65          -65          -65          -65          -65          -65          -65          -65          -65          -65          -65          -65          -65          -65          -65          -65          -65          -65          -65          -65          -65          -65          -65          -65          -65          -65          -65          -65          -65          -65          -65          -65          -65          -65          -65          -65          -65          -65          -65          -65          -65          -65          -65          -65          -65          -65          -65          -65          -65          -65          -65          -65          -65          -65          -65          -65          -65          -65          -65          -65        0.317        0.317        0.317        0.317        0.317        0.317        0.317        0.317        0.317        0.317        0.317        0.317        0.317        0.317        0.317        0.317        0.317        0.317        0.317        0.317        0.317        0.317        0.317        0.317        0.317        0.317        0.317        0.317        0.317        0.317        0.317        0.317        0.317        0.317        0.317        0.317        0.317        0.317        0.317        0.317        0.317        0.317        0.317        0.317        0.317        0.317        0.317        0.317        0.317        0.317        0.317        0.317        0.317        0.317        0.317        0.317        0.317        0.317        0.317        0.317        0.317        0.317        0.317        0.317        0.317        0.317        0.317        0.317        0.317        0.317        0.317        0.317        0.317        0.317        0.317        0.317        0.317        0.317        0.317        0.317        0.317        0.317        0.317        0.317        0.317        0.317        0.317        0.317        0.317        0.317        0.317        0.317        0.317        0.317        0.317        0.317        0.317        0.317        0.317        0.317        0.317        0.317        0.317        0.317        0.317        0.317        0.317        0.317        0.317        0.317        0.317        0.317        0.317        0.317        0.317        0.317        0.317        0.317        0.317        0.317        0.317        0.317        0.317        0.317        0.317        0.317        0.317        0.317        0.317        0.317        0.317        0.317        0.317        0.317        0.317        0.317        0.317        0.317        0.317        0.317        0.317        0.317        0.317        0.317        0.317        0.317        0.317        0.317        0.317        0.317        0.317        0.317        0.317        0.317        0.317        0.317        0.317        0.317        0.317        0.317        0.317        0.317        0.317        0.317        0.317        0.317        0.317        0.317        0.317        0.317        0.317        0.317        0.317        0.317        0.317        0.317        0.317        0.317        0.317        0.317        0.317        0.317        0.317        0.317        0.317        0.317        0.317        0.317        0.317        0.317        0.317        0.317        0.317        0.317        0.317        0.317        0.317        0.317        0.317        0.317        0.052        0.052        0.052        0.052        0.052        0.052        0.052        0.052        0.052        0.052        0.052        0.052        0.052        0.052        0.052        0.052        0.052        0.052        0.052        0.052        0.052        0.052        0.052        0.052        0.052        0.052        0.052        0.052        0.052        0.052        0.052        0.052        0.052        0.052        0.052        0.052        0.052        0.052        0.052        0.052        0.052        0.052        0.052        0.052        0.052        0.052        0.052        0.052        0.052        0.052        0.052        0.052        0.052        0.052        0.052        0.052        0.052        0.052        0.052        0.052        0.052        0.052        0.052        0.052        0.052        0.052        0.052        0.052        0.052        0.052        0.052        0.052        0.052        0.052        0.052        0.052        0.052        0.052        0.052        0.052        0.052        0.052        0.052        0.052        0.052        0.052        0.052        0.052        0.052        0.052        0.052        0.052        0.052        0.052        0.052        0.052        0.052        0.052        0.052        0.052        0.052        0.052        0.052        0.052        0.052        0.052        0.052        0.052        0.052        0.052        0.052        0.052        0.052        0.052        0.052        0.052        0.052        0.052        0.052        0.052        0.052        0.052        0.052        0.052        0.052        0.052        0.052        0.052        0.052        0.052        0.052        0.052        0.052        0.052        0.052        0.052        0.052        0.052        0.052        0.052        0.052        0.052        0.052        0.052        0.052        0.052        0.052        0.052        0.052        0.052        0.052        0.052        0.052        0.052        0.052        0.052        0.052        0.052        0.052        0.052        0.052        0.052        0.052        0.052        0.052        0.052        0.052        0.052        0.052        0.052        0.052        0.052        0.052        0.052        0.052        0.052        0.052        0.052        0.052        0.052        0.052        0.052        0.052        0.052        0.052        0.052        0.052        0.052        0.052        0.052        0.052        0.052        0.052        0.052        0.052        0.052        0.052        0.052        0.052        0.052        0.596        0.596        0.596        0.596        0.596        0.596        0.596        0.596        0.596        0.596        0.596        0.596        0.596        0.596        0.596        0.596        0.596        0.596        0.596        0.596        0.596        0.596        0.596        0.596        0.596        0.596        0.596        0.596        0.596        0.596        0.596        0.596        0.596        0.596        0.596        0.596        0.596        0.596        0.596        0.596        0.596        0.596        0.596        0.596        0.596        0.596        0.596        0.596        0.596        0.596        0.596        0.596        0.596        0.596        0.596        0.596        0.596        0.596        0.596        0.596        0.596        0.596        0.596        0.596        0.596        0.596        0.596        0.596        0.596        0.596        0.596        0.596        0.596        0.596        0.596        0.596        0.596        0.596        0.596        0.596        0.596        0.596        0.596        0.596        0.596        0.596        0.596        0.596        0.596        0.596        0.596        0.596        0.596        0.596        0.596        0.596        0.596        0.596        0.596        0.596        0.596        0.596        0.596        0.596        0.596        0.596        0.596        0.596        0.596        0.596        0.596        0.596        0.596        0.596        0.596        0.596        0.596        0.596        0.596        0.596        0.596        0.596        0.596        0.596        0.596        0.596        0.596        0.596        0.596        0.596        0.596        0.596        0.596        0.596        0.596        0.596        0.596        0.596        0.596        0.596        0.596        0.596        0.596        0.596        0.596        0.596        0.596        0.596        0.596        0.596        0.596        0.596        0.596        0.596        0.596        0.596        0.596        0.596        0.596        0.596        0.596        0.596        0.596        0.596        0.596        0.596        0.596        0.596        0.596        0.596        0.596        0.596        0.596        0.596        0.596        0.596        0.596        0.596        0.596        0.596        0.596        0.596        0.596        0.596        0.596        0.596        0.596        0.596        0.596        0.596        0.596        0.596        0.596        0.596        0.596        0.596        0.596        0.596        0.596        0.596            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0          0.1          0.1          0.1          0.1          0.1          0.1          0.1          0.1          0.1          0.1          0.1          0.1          0.1          0.1          0.1          0.1          0.1          0.1          0.1          0.1          0.1          0.1          0.1          0.1          0.1          0.1          0.1          0.1          0.1          0.1          0.1          0.1          0.1          0.1          0.1          0.1          0.1          0.1          0.1          0.1          0.1          0.1          0.1          0.1          0.1          0.1          0.1          0.1          0.1          0.1          0.1          0.1          0.1          0.1          0.1          0.1          0.1          0.1          0.1          0.1          0.1          0.1          0.1          0.1          0.1          0.1          0.1          0.1          0.1          0.1          0.1          0.1          0.1          0.1          0.1          0.1          0.1          0.1          0.1          0.1          0.1          0.1          0.1          0.1          0.1          0.1          0.1          0.1          0.1          0.1          0.1          0.1          0.1          0.1          0.1          0.1          0.1          0.1          0.1          0.1          0.1          0.1          0.1          0.1          0.1          0.1          0.1          0.1          0.1          0.1          0.1          0.1          0.1          0.1          0.1          0.1          0.1          0.1          0.1          0.1          0.1          0.1          0.1          0.1          0.1          0.1          0.1          0.1          0.1          0.1          0.1          0.1          0.1          0.1          0.1          0.1          0.1          0.1          0.1          0.1          0.1          0.1          0.1          0.1          0.1          0.1          0.1          0.1          0.1          0.1          0.1          0.1          0.1          0.1          0.1          0.1          0.1          0.1          0.1          0.1          0.1          0.1          0.1          0.1          0.1          0.1          0.1          0.1          0.1          0.1          0.1          0.1          0.1          0.1          0.1          0.1          0.1          0.1          0.1          0.1          0.1          0.1          0.1          0.1          0.1          0.1          0.1          0.1          0.1          0.1          0.1          0.1          0.1          0.1          0.1          0.1          0.1          0.1          0.1          0.1          -65          -65          -65          -65          -65          -65          -65          -65          -65          -65          -65          -65          -65          -65          -65          -65          -65          -65          -65          -65          -65          -65          -65          -65          -65          -65          -65          -65          -65          -65          -65          -65          -65          -65          -65          -65          -65          -65          -65          -65          -65          -65          -65          -65          -65          -65          -65          -65          -65          -65          -65          -65          -65          -65          -65          -65          -65          -65          -65          -65          -65          -65          -65          -65          -65          -65          -65          -65          -65          -65          -65          -65          -65          -65          -65          -65          -65          -65          -65          -65          -65          -65          -65          -65          -65          -65          -65          -65          -65          -65          -65          -65          -65          -65          -65          -65          -65          -65          -65          -65          -65          -65          -65          -65          -65          -65          -65          -65          -65          -65          -65          -65          -65          -65          -65          -65          -65          -65          -65          -65          -65          -65          -65          -65          -65          -65          -65          -65          -65          -65          -65          -65          -65          -65          -65          -65          -65          -65          -65          -65          -65          -65          -65          -65          -65          -65          -65          -65          -65          -65          -65          -65          -65          -65          -65          -65          -65          -65          -65          -65          -65          -65          -65          -65          -65          -65          -65          -65          -65          -65          -65          -65          -65          -65          -65          -65          -65          -65          -65          -65          -65          -65          -65          -65          -65          -65          -65          -65          -65          -65          -65          -65          -65          -65          -65          -65          -65          -65          -65          -65        0.317        0.317        0.317        0.317        0.317        0.317        0.317        0.317        0.317        0.317        0.317        0.317        0.317        0.317        0.317        0.317        0.317        0.317        0.317        0.317        0.317        0.317        0.317        0.317        0.317        0.317        0.317        0.317        0.317        0.317        0.317        0.317        0.317        0.317        0.317        0.317        0.317        0.317        0.317        0.317        0.317        0.317        0.317        0.317        0.317        0.317        0.317        0.317        0.317        0.317        0.317        0.317        0.317        0.317        0.317        0.317        0.317        0.317        0.317        0.317        0.317        0.317        0.317        0.317        0.317        0.317        0.317        0.317        0.317        0.317        0.317        0.317        0.317        0.317        0.317        0.317        0.317        0.317        0.317        0.317        0.317        0.317        0.317        0.317        0.317        0.317        0.317        0.317        0.317        0.317        0.317        0.317        0.317        0.317        0.317        0.317        0.317        0.317        0.317        0.317        0.317        0.317        0.317        0.317        0.317        0.317        0.317        0.317        0.317        0.317        0.317        0.317        0.317        0.317        0.317        0.317        0.317        0.317        0.317        0.317        0.317        0.317        0.317        0.317        0.317        0.317        0.317        0.317        0.317        0.317        0.317        0.317        0.317        0.317        0.317        0.317        0.317        0.317        0.317        0.317        0.317        0.317        0.317        0.317        0.317        0.317        0.317        0.317        0.317        0.317        0.317        0.317        0.317        0.317        0.317        0.317        0.317        0.317        0.317        0.317        0.317        0.317        0.317        0.317        0.317        0.317        0.317        0.317        0.317        0.317        0.317        0.317        0.317        0.317        0.317        0.317        0.317        0.317        0.317        0.317        0.317        0.317        0.317        0.317        0.317        0.317        0.317        0.317        0.317        0.317        0.317        0.317        0.317        0.317        0.317        0.317        0.317        0.317        0.317        0.317        0.052        0.052        0.052        0.052        0.052        0.052        0.052        0.052        0.052        0.052        0.052        0.052        0.052        0.052        0.052        0.052        0.052        0.052        0.052        0.052        0.052        0.052        0.052        0.052        0.052        0.052        0.052        0.052        0.052        0.052        0.052        0.052        0.052        0.052        0.052        0.052        0.052        0.052        0.052        0.052        0.052        0.052        0.052        0.052        0.052        0.052        0.052        0.052        0.052        0.052        0.052        0.052        0.052        0.052        0.052        0.052        0.052        0.052        0.052        0.052        0.052        0.052        0.052        0.052        0.052        0.052        0.052        0.052        0.052        0.052        0.052        0.052        0.052        0.052        0.052        0.052        0.052        0.052        0.052        0.052        0.052        0.052        0.052        0.052        0.052        0.052        0.052        0.052        0.052        0.052        0.052        0.052        0.052        0.052        0.052        0.052        0.052        0.052        0.052        0.052        0.052        0.052        0.052        0.052        0.052        0.052        0.052        0.052        0.052        0.052        0.052        0.052        0.052        0.052        0.052        0.052        0.052        0.052        0.052        0.052        0.052        0.052        0.052        0.052        0.052        0.052        0.052        0.052        0.052        0.052        0.052        0.052        0.052        0.052        0.052        0.052        0.052        0.052        0.052        0.052        0.052        0.052        0.052        0.052        0.052        0.052        0.052        0.052        0.052        0.052        0.052        0.052        0.052        0.052        0.052        0.052        0.052        0.052        0.052        0.052        0.052        0.052        0.052        0.052        0.052        0.052        0.052        0.052        0.052        0.052        0.052        0.052        0.052        0.052        0.052        0.052        0.052        0.052        0.052        0.052        0.052        0.052        0.052        0.052        0.052        0.052        0.052        0.052        0.052        0.052        0.052        0.052        0.052        0.052        0.052        0.052        0.052        0.052        0.052        0.052        0.596        0.596        0.596        0.596        0.596        0.596        0.596        0.596        0.596        0.596        0.596        0.596        0.596        0.596        0.596        0.596        0.596        0.596        0.596        0.596        0.596        0.596        0.596        0.596        0.596        0.596        0.596        0.596        0.596        0.596        0.596        0.596        0.596        0.596        0.596        0.596        0.596        0.596        0.596        0.596        0.596        0.596        0.596        0.596        0.596        0.596        0.596        0.596        0.596        0.596        0.596        0.596        0.596        0.596        0.596        0.596        0.596        0.596        0.596        0.596        0.596        0.596        0.596        0.596        0.596        0.596        0.596        0.596        0.596        0.596        0.596        0.596        0.596        0.596        0.596        0.596        0.596        0.596        0.596        0.596        0.596        0.596        0.596        0.596        0.596        0.596        0.596        0.596        0.596        0.596        0.596        0.596        0.596        0.596        0.596        0.596        0.596        0.596        0.596        0.596        0.596        0.596        0.596        0.596        0.596        0.596        0.596        0.596        0.596        0.596        0.596        0.596        0.596        0.596        0.596        0.596        0.596        0.596        0.596        0.596        0.596        0.596        0.596        0.596        0.596        0.596        0.596        0.596        0.596        0.596        0.596        0.596        0.596        0.596        0.596        0.596        0.596        0.596        0.596        0.596        0.596        0.596        0.596        0.596        0.596        0.596        0.596        0.596        0.596        0.596        0.596        0.596        0.596        0.596        0.596        0.596        0.596        0.596        0.596        0.596        0.596        0.596        0.596        0.596        0.596        0.596        0.596        0.596        0.596        0.596        0.596        0.596        0.596        0.596        0.596        0.596        0.596        0.596        0.596        0.596        0.596        0.596        0.596        0.596        0.596        0.596        0.596        0.596        0.596        0.596        0.596        0.596        0.596        0.596        0.596        0.596        0.596        0.596        0.596        0.596            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0];

[t,y]=ode23(ODEFUN,[0 100],IC);   % numerical integration
figure; plot(t,y);           % plot all variables/functions
try legend('HH\_v','HH\_K\_n','HH\_Na\_m','HH\_Na\_h','HH\_iM\_mM','HH\_HH\_iSYN\_s','HH2\_v','HH2\_K\_n','HH2\_Na\_m','HH2\_Na\_h','HH2\_iM\_mM'); end
%-
%}
